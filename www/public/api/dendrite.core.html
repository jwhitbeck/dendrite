<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>dendrite.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Dendrite 0.4.5-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dendrite</span></div></div></li><li class="depth-2 current"><a href="dendrite.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="dendrite.core.html#var-col"><div class="inner"><span>col</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-custom-types"><div class="inner"><span>custom-types</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-file-reader"><div class="inner"><span>file-reader</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-file-writer"><div class="inner"><span>file-writer</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-files-reader"><div class="inner"><span>files-reader</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-filter"><div class="inner"><span>filter</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-filter-indexed"><div class="inner"><span>filter-indexed</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-full-schema"><div class="inner"><span>full-schema</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-keep"><div class="inner"><span>keep</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-keep-indexed"><div class="inner"><span>keep-indexed</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-map"><div class="inner"><span>map</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-map-indexed"><div class="inner"><span>map-indexed</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-metadata"><div class="inner"><span>metadata</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-num-records"><div class="inner"><span>num-records</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-pprint"><div class="inner"><span>pprint</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-read"><div class="inner"><span>read</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-read-schema-string"><div class="inner"><span>read-schema-string</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-remove"><div class="inner"><span>remove</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-remove-indexed"><div class="inner"><span>remove-indexed</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-req"><div class="inner"><span>req</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-sample"><div class="inner"><span>sample</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-schema"><div class="inner"><span>schema</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-set-metadata.21"><div class="inner"><span>set-metadata!</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-stats"><div class="inner"><span>stats</span></div></a></li><li class="depth-1"><a href="dendrite.core.html#var-tag"><div class="inner"><span>tag</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">dendrite.core</h2><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-col"><h3>col</h3><div class="usage"><code>(col type)</code><code>(col type encoding)</code><code>(col type encoding compression)</code></div><div class="doc"><pre class="plaintext">Returns a column specification. Takes one to three arguments:
- type         the column type symbol (e.g. int)
- encoding     the column encoding symbol (default: plain)
- compression  the column compression symbol (default: none)

See README for all supported encoding/compression types.</pre></div></div><div class="public anchor" id="var-custom-types"><h3>custom-types</h3><div class="usage"><code>(custom-types reader)</code></div><div class="doc"><pre class="plaintext">Returns a map of custom-type to base-type.
</pre></div></div><div class="public anchor" id="var-file-reader"><h3>file-reader</h3><div class="usage"><code>(file-reader file)</code><code>(file-reader opts file)</code></div><div class="doc"><pre class="plaintext">Returns a dendrite reader for the provided file.

If provided, the options map supports the following keys:
:custom-types  - a map of of custom-type symbol to custom-type specification. Default: nil. See docs for
                full explanation.</pre></div></div><div class="public anchor" id="var-file-writer"><h3>file-writer</h3><div class="usage"><code>(file-writer schema file)</code><code>(file-writer opts schema file)</code></div><div class="doc"><pre class="plaintext">Returns a dendrite writer that outputs to a file according to the provided schema.

If provided, the options map supports the following keys:

:data-page-length         The length in bytes of the data pages (default 262144)

:record-group-length      The length in bytes of each record group (default 134217728)

:optimize-columns?        Either :all, :none or :default. If :all, will attempt to optimize the
                          encoding and compression for each column; if :default, will only optimize
                          columns with the default encoding &amp; compression (i.e., plain/none); if :none,
                          disables all optimization.

:compression-thresholds   A map of compression method (e.g., deflate) to the minimum compression ratio
                          (e.g., 2) below which the overhead of compression is not not deemed worthwhile.
                          Default: {&apos;deflate 1.5}

:invalid-input-handler    A function with two arguments: record and exception. If an input record does
                          not conform to the schema, it will be passed to this function along with the
                          exception it triggered. By default, this option is nil and exceptions
                          triggered by invalid records are not caught.

:custom-types             A map of of custom-type symbol to custom-type specification. See docs for
                          full explanation.

:map-fn                   Apply this function to all written records before striping them to columns. This
                          function is applied as part of the parallelized striping process.

:ignore-extra-fields?     If true (default), ignore record fields that are not part of the schema upon
                          writing to file. If false, will throw an exception if a record contains a field
                          not defined in the schema.</pre></div></div><div class="public anchor" id="var-files-reader"><h3>files-reader</h3><div class="usage"><code>(files-reader files)</code><code>(files-reader opts files)</code></div><div class="doc"><pre class="plaintext">Returns a dendrite reader on the provided files (a seq of files or string paths). Reads will query each
file in the provided order, opening and closing them as needed. Accepts all the same options as
file-reader.</pre></div></div><div class="public anchor" id="var-filter"><h3>filter</h3><div class="usage"><code>(filter f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records containing only those such that (f record) evaluates truthfully. The
filtering is done as part of record assembly. As with read, this view is seqable, reducible, and
foldable. Calling (d/filter f (d/read r)) is equivalent to (filter f (d/read r)) but more efficient.</pre></div></div><div class="public anchor" id="var-filter-indexed"><h3>filter-indexed</h3><div class="usage"><code>(filter-indexed f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records containing only those such that (f index record) evaluates truthfully. The
filtering is done as part of record assembly. As with read, this view is seqable, reducible, and
foldable. However, this equivalence does not extend to nested calls to keep-indexed. See map-indexed for
details.</pre></div></div><div class="public anchor" id="var-full-schema"><h3>full-schema</h3><div class="usage"><code>(full-schema reader)</code></div><div class="doc"><pre class="plaintext">Returns this reader&apos;s schema with all encoding and compression annotations.
</pre></div></div><div class="public anchor" id="var-keep"><h3>keep</h3><div class="usage"><code>(keep f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records with the provided function mapped on to each record as part of record
assembly and all nil values removed. As with read, this view is seqable, reducible, and
foldable. Calling (d/keep f (d/read r)) is equivalent to (keep f (d/read r)) but more efficient.</pre></div></div><div class="public anchor" id="var-keep-indexed"><h3>keep-indexed</h3><div class="usage"><code>(keep-indexed f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records with the provided function mapped on to each record and its index as part of
record assembly and all nil values removed. As with read, this view is seqable, reducible, and
foldable. Calling (d/keep-indexed f (d/read r)) is equivalent to (keep-indexed f (d/read r)) but more
efficient. However, this equivalence does not extend to nested calls to keep-indexed. See map-indexed for
details.</pre></div></div><div class="public anchor" id="var-map"><h3>map</h3><div class="usage"><code>(map f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records with the provided function mapped on to each record as part of record
assembly. As with read, this view is seqable, reducible, and foldable. Calling (d/map f (d/read r)) is
equivalent to (map f (d/read r)) but more efficient.</pre></div></div><div class="public anchor" id="var-map-indexed"><h3>map-indexed</h3><div class="usage"><code>(map-indexed f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records with the provided function mapped on to each record and its index as part of
record assembly. As with read, this view is seqable, reducible, and foldable. Calling
(d/map-indexed f (d/read r)) is equivalent to (map-indexed f (d/read r)) but more efficient. However, this
equivalence does not extend to chaining calls to d/map-indexed or any other d/*-indexed function. Indeed the
index argument passed to f is always the record&apos;s index in the file, wheread in clojure.core/map-indexed, a
new index is generated for each nested lazy-seq. Therefore (-&gt;&gt; (d/read r) (d/map-indexed f) (d/map-indexed
g)) will not in general be equivalent to (-&gt;&gt; (d/read r) (map-indexed f) (map-indexed f)).</pre></div></div><div class="public anchor" id="var-metadata"><h3>metadata</h3><div class="usage"><code>(metadata reader)</code></div><div class="doc"><pre class="plaintext">Returns the user-defined metadata for this reader.
</pre></div></div><div class="public anchor" id="var-num-records"><h3>num-records</h3><div class="usage"><code>(num-records reader)</code></div><div class="doc"><pre class="plaintext">Returns the number of records in the file.
</pre></div></div><div class="public anchor" id="var-pprint"><h3>pprint</h3><div class="usage"><code>(pprint schema)</code></div><div class="doc"><pre class="plaintext">Pretty-prints the schema.
</pre></div></div><div class="public anchor" id="var-read"><h3>read</h3><div class="usage"><code>(read reader)</code><code>(read opts reader)</code></div><div class="doc"><pre class="plaintext">Returns a view of all the records in the reader. This view is seqable (lazy), reducible, and foldable (per
clojure.core.reducers, in which case the folding is done as part of record assembly).

If provided, the options map supports the following keys:

:missing-fields-as-nil?  Set to true (default) or false. If true, then fields that are specified in the
                         query but are not present in this reader&apos;s schema will be read as nil values. If
                         false, querying for fields not present in the schema will throw an exception.

:query                   The query. Default: &apos;_. See docs for full explanation.

:sub-schema-in           Path to the desired sub-schema. The value should be a sequence of keys that cannot
                         contain any keys to repeated elements. If both :sub-schema-in and :query are
                         defined, the query applies to the specified sub-schema. See docs for full
                         explanation.

:readers                 A map of query tag symbol to tag function. Default: nil. See docs for full
                         explanation.</pre></div></div><div class="public anchor" id="var-read-schema-string"><h3>read-schema-string</h3><div class="usage"><code>(read-schema-string s)</code></div><div class="doc"><pre class="plaintext">Parse an edn-formatted dendrite schema string.
</pre></div></div><div class="public anchor" id="var-remove"><h3>remove</h3><div class="usage"><code>(remove f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records not containing any of those such that (f record) evaluates truthfully. The
removal is done as part of record assembly. As with read, this view is seqable, reducible, and
foldable. Calling (d/remove f (d/read r)) is equivalent to (remove f (d/read r)) but more efficient.</pre></div></div><div class="public anchor" id="var-remove-indexed"><h3>remove-indexed</h3><div class="usage"><code>(remove-indexed f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records not containing any of those such that (f index record) evaluates truthfully.
The removal is done as part of record assembly. As with read, this view is seqable, reducible, and
foldable. However, this equivalence does not extend to nested calls to keep-indexed. See map-indexed for
details.</pre></div></div><div class="public anchor" id="var-req"><h3>req</h3><div class="usage"><code>(req x)</code></div><div class="doc"><pre class="plaintext">Marks the enclosed schema element as required.
</pre></div></div><div class="public anchor" id="var-sample"><h3>sample</h3><div class="usage"><code>(sample f view)</code></div><div class="doc"><pre class="plaintext">Returns a view of the records containing only those such that (f record-index) evaluates truthfully, where
record-index goes from 0 (first record) to num-records - 1 (last record). The sampling occurs before record
assembly thereby skipping assembly entirely for unselected records. As with read, this view is seqable,
reducible, and foldable. A view can only have a single sample function applied to it and the sample
function must be applied before any mapping or filtering function.</pre></div></div><div class="public anchor" id="var-schema"><h3>schema</h3><div class="usage"><code>(schema reader)</code></div><div class="doc"><pre class="plaintext">Returns this reader&apos;s schema.
</pre></div></div><div class="public anchor" id="var-set-metadata.21"><h3>set-metadata!</h3><div class="usage"><code>(set-metadata! writer metadata)</code></div><div class="doc"><pre class="plaintext">Sets the user-defined metadata for this writer.
</pre></div></div><div class="public anchor" id="var-stats"><h3>stats</h3><div class="usage"><code>(stats reader)</code></div><div class="doc"><pre class="plaintext">Returns a map containing all the stats associated with this reader. The tree top-level keys
are :global, :record-groups, and :columns, that, respectively, contain stats summed over the entire file,
summed across all column-chunks in the same record-groups, and summed across all column-chunks belonging to
the same column.</pre></div></div><div class="public anchor" id="var-tag"><h3>tag</h3><div class="usage"><code>(tag tag elem)</code></div><div class="doc"><pre class="plaintext">Tags the enclosed query element with the provided tag. Meant to be used in combination with the :readers
option.</pre></div></div></div></body></html>